import{r as s,g as E,o as Q,p as R,q as X,U as Y,j as t,y as Z,V as _,c as tt,R as et}from"./auth-7a6rBG4F.js";import{S as st}from"./student_tile--9XwV1Kh.js";import{E as ot,C as at}from"./close_warning_dialog-_CwKV2tA.js";import{S as nt}from"./search_bar-L5nwHk8M.js";import{B as rt}from"./back_arrow-IdcwQJqZ.js";import{C as ct}from"./close-CDqjbHS0.js";import{I as it}from"./info_dialog-q-ePwUyF.js";import"./trash-arEgRoH7.js";function dt(){const[h,k]=s.useState([]),[b,y]=s.useState(""),[i,D]=s.useState(""),[d,P]=s.useState(""),[T,B]=s.useState(""),j=s.useRef(null),[U,v]=s.useState(""),[F,L]=s.useState(""),[M,A]=s.useState(""),[W,q]=s.useState(""),V=s.useRef(null),[$,lt]=s.useState(),[z,H]=s.useState(""),[f,J]=s.useState([]),[u,K]=s.useState(""),[S,I]=s.useState(""),[l,x]=s.useState([]),n=s.useRef(null);s.useEffect(()=>{w(),console.log("Fetched Students")},[]);async function w(){const e=await E();B(e);const r=window.location.search,a=new URLSearchParams(r);if(!a.has("classId"))throw Error("missing class id!");if(!a.has("projectId"))throw Error("missing project id!");if(!a.has("groupId"))throw Error("missing group id");const o=a.get("classId");P(o);const c=await Q(o),C=await R(c.students);k(C);const p=a.get("projectId"),m=await X(o,p);A(m.background),y(m.name),q(m.backgroundColor),D(p);const G=a.get("groupId");K(G);const g=await Y(o,p,G);H(g.name),I(g.name);const N=await R(g.students);J(N),x(N)}const O=async()=>{var r,a;const e=l.map(o=>o.id);for(let o=0;o<l.length;o++){const c=l[o];if(await Z(d,i,c.id,u)){v(`${c.name} is already in another group`),L("Unable to edit group"),(r=j.current)==null||r.showModal();return}}await _(d,i,u,S,e),await w(),(a=n.current)==null||a.close()};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"Center "+M,style:{backgroundColor:W},children:[t.jsx("h2",{className:"Title",children:z}),t.jsx("div",{className:"TeacherIcons",children:t.jsx("img",{src:ot,alt:"edit group",className:"EditIcon",onClick:()=>{var e;(e=n.current)==null||e.showModal()}})}),t.jsx("img",{src:rt,alt:"back",className:"BackArrow",onClick:()=>{const e=new URL(window.location.href);e.searchParams.delete("groupId"),window.location.href=e.origin+"/Project/"+e.search}}),t.jsx("h3",{children:"Students:"}),t.jsx("div",{className:"Students",children:f.map(e=>t.jsx(st,{name:e.name,id:e.id,projectId:i,classId:d,groupId:u,projectName:b},e.id))}),t.jsx("br",{})]}),t.jsxs("dialog",{ref:n,children:[t.jsx("h2",{children:"Edit Group"}),t.jsx("img",{src:ct,alt:"close",className:"CloseIcon",onClick:()=>{var e;(e=n.current)==null||e.close()}}),t.jsxs("form",{children:[t.jsx("label",{htmlFor:"groupName",children:"Group Name:"}),t.jsx("span",{children:" "}),t.jsx("input",{type:"text",name:"groupName",id:"groupName",value:S,onChange:e=>{I(e.target.value)}}),t.jsx("br",{}),t.jsx("label",{htmlFor:"",className:"InviteTitle",children:"Students: "}),t.jsx(nt,{name:"Student",content:h,currentUserId:T,defaultAddedContent:f,updateContent:e=>{x(e)}}),t.jsx("br",{}),t.jsx("button",{type:"button",onClick:O,children:"Edit Group"})]})]}),t.jsx(it,{info:U,Title:F,infoModalRef:j}),t.jsx(at,{closeWarningRef:V,connectedRef:$})]})}async function ut(){await E()||(window.location.href=window.location.origin+"/Login/")}(async()=>await ut())();tt.createRoot(document.getElementById("root")).render(t.jsx(et.StrictMode,{children:t.jsx(dt,{})}));
