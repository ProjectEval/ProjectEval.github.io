import{j as s,r as t,d as D,e as T,f as F,h as P,k as M,l as A,m as B,n as q,g as z,i as G}from"./auth-OIc4apUQ.js";import{T as H,C as J}from"./close-KeMSzLwU.js";import{P as K}from"./plus-Ip2amvQB.js";import{S as C}from"./search_bar-DzdhLxBV.js";import{E as Q}from"./error_dialog-qsErQp_K.js";function f({name:n,id:r,isTeacher:c,deleteClass:l}){return s.jsx(s.Fragment,{children:s.jsxs("div",{className:"ClassTile",onClick:()=>{const a=new URL(window.location.origin);a.searchParams.set("classId",r),window.location.href=a.origin+"/Projects/"+a.search},children:[s.jsx("h2",{className:"ClassName",children:n}),c&&s.jsx("img",{className:"ClassTrashIcon",src:H,alt:"Trash Icon",onClick:a=>{a.stopPropagation(),l()}})]})})}function V({id:n}){const[r,c]=t.useState([]);t.useEffect(()=>{async function a(){const o=await D(n);c(o)}a(),console.log(r)},[]);const l=async()=>{await T(),localStorage.removeItem("userType"),window.location.href=window.location.origin+"/Login/"};return s.jsx(s.Fragment,{children:s.jsxs("div",{className:"Center",children:[s.jsx("h2",{className:"Title",children:"Student Classes"}),s.jsxs("div",{className:"Classes",children:[r.map(a=>s.jsx(f,{name:a.name,id:a.id,isTeacher:!1},a.name)),s.jsx("button",{className:"LogOut",onClick:l,children:"Log Out"})]}),s.jsx("br",{})]})})}function W({id:n}){const[r,c]=t.useState([]),[l,a]=t.useState([]),o=t.useRef(null),x=t.useRef(null),[S,p]=t.useState(""),[w,N]=t.useState(""),[I,b]=t.useState([]),[d,y]=t.useState(""),[k,v]=t.useState([]),[E,L]=t.useState([]);t.useEffect(()=>{u(),console.log(r)},[]);async function u(){const e=await F(n);c(e);const i=await P();a(i);const h=await M();v(h)}const O=async()=>{var j,g;if(await A(d)){p("This class name is already taken!"),N("Class Name Taken"),(j=x.current)==null||j.showModal();return}const i=I.map(m=>m.id);i.push(n);const h=E.map(m=>m.id);await B(d,h,i),(g=o.current)==null||g.close(),u()},R=async()=>{await T(),localStorage.removeItem("userType"),window.location.href=window.location.origin+"/Login/"},U=e=>async()=>{await q(e),u()};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"Center",children:[s.jsx("h2",{className:"Title",children:"Teacher Classes"}),s.jsx("img",{src:K,alt:"add class",className:"PlusIcon",onClick:()=>{var e;(e=o.current)==null||e.showModal()}}),s.jsxs("div",{className:"Classes",children:[r.map(e=>s.jsx(f,{name:e.name,id:e.id,isTeacher:!0,deleteClass:U(e.id)},e.name)),s.jsx("button",{className:"LogOut",onClick:R,children:"Log Out"})]}),s.jsx("br",{})]}),s.jsxs("dialog",{ref:o,children:[s.jsx("h2",{children:"Create Class"}),s.jsx("img",{src:J,alt:"close",className:"CloseIcon",onClick:()=>{var e;(e=o.current)==null||e.close()}}),s.jsxs("form",{children:[s.jsx("label",{htmlFor:"className",children:"Class Name:"}),s.jsx("span",{children:" "}),s.jsx("input",{type:"text",name:"className",id:"className",value:d,onChange:e=>{y(e.target.value)}}),s.jsx("br",{}),s.jsx("label",{htmlFor:"",children:"Other Teachers: "}),s.jsx(C,{name:"Teacher",content:l,currentUserId:n,updateContent:e=>{b(e)}}),s.jsx("br",{}),s.jsx("label",{htmlFor:"",children:"Students: "}),s.jsx(C,{name:"Student",content:k,currentUserId:n,updateContent:e=>{L(e)}}),s.jsx("br",{}),s.jsx("button",{type:"button",onClick:O,children:"Create Class"})]})]}),s.jsx(Q,{error:S,errorTitle:w,errorModalRef:x})]})}function ss(){const[n,r]=t.useState(),[c,l]=t.useState("");return t.useEffect(()=>{(async()=>{const a=await z(),o=await G(a);console.log(localStorage.getItem("userType")),console.log(a+" Dashboard"),a&&l(a),r(o?"Teacher":"Student")})()},[]),s.jsx(s.Fragment,{children:n=="Student"?s.jsx(V,{id:c}):n=="Teacher"?s.jsx(W,{id:c}):null})}export{ss as D};
